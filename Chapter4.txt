This is Chapter 4 in Master branch.